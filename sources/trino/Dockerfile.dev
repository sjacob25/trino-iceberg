FROM trinodb/trino:latest

# Add custom plugins or modifications here
USER root

# Clone specific Trino plugins from GitHub
RUN apt-get update && apt-get install -y git curl
RUN git clone https://github.com/trinodb/trino.git /tmp/trino-source

# Copy specific plugin modifications
# RUN cp /tmp/trino-source/plugin/trino-iceberg/src/main/java/io/trino/plugin/iceberg/* \
#     /usr/lib/trino/plugin/iceberg/

# Add PostgreSQL driver
RUN curl -o /usr/lib/trino/plugin/iceberg/postgresql.jar \
    https://jdbc.postgresql.org/download/postgresql-42.7.1.jar

# Clean up
RUN rm -rf /tmp/trino-source && apt-get clean

USER trino
